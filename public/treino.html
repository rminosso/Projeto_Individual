<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="./assets/imgs/icone.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitLife | Treino</title>

    <link rel="stylesheet" href="./css/dashboards.css">
    <link rel="stylesheet" href="./css/estilo.css" />

    <script src="../js/sessao.js"></script>
</head>

<body>
    <div class="kpi_container">

        <div class="card_kpi">
            <h3 style="color: #ccc;">Prioridade Muscular</h3>
            <span id="kpi_prioridade"></span>
            <span style="color: white;"></span>
        </div>

        <div class="card_kpi">
            <h3 style="color: #ccc;">Disponibilidade de Treino</h3>
            <span id="kpi_disponibilidade"></span>
            <br>
        </div>
    </div>

    <div class="janela">
        <div class="header-left">
            <h1>FitLife</h1>

            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>

            <div class="btn-nav">
                <a href="Dashboard.html">
                    <h3>Minha Evolução</h3>
                </a>
            </div>

            <div class="btn-nav-white">
                <a href="inserirMedidas.html">
                    <h3>Adicionar Medidas</h3>
                </a>
            </div>

            <div class="btn-nav-white">
                <a href="treino.html">
                    <h3>Treino Sugerido</h3>
                </a>
            </div>

            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>
        </div>

        <div class="sugestao_container">

            <div class="titulo-secao">
                <h2 style="color: white; text-align: center;">Seu Plano Sugerido</h2>
            </div>

            <div id="container_treino_sugerido" class="container_treino">
            </div>
</body>
<script>
    function buscarTreino() {
    var nomeUsuario = sessionStorage.NOME_USUARIO;
    var prioridade = sessionStorage.PRIORIDADE_USUARIO;
    var disponibilidade = sessionStorage.DISPONIBILIDADE_USUARIO;
    var nivel = sessionStorage.NIVEL_USUARIO;

    document.getElementById("b_usuario").innerHTML = nomeUsuario;
    document.getElementById("kpi_prioridade").innerHTML = prioridade;
    document.getElementById("kpi_disponibilidade").innerHTML = disponibilidade + " dias";

    fetch(`/treinos/buscar?tipo=${prioridade}&diasSemana=${disponibilidade}&nivel=${nivel}`, {
    method: "GET"
    }).then(function(resposta){
        if(resposta.ok){
            if(resposta.status == 204){
                document.getElementById("container_treino_sugerido").innerHTML = "Nenhum treino encontrado.";
                return;
            }
        resposta.json().then(function (treinos) {
                var container = document.getElementById("container_treino_sugerido");
                container.innerHTML = "";
                for (let i = 0; i < treinos.length; i++) {
                    var treino = treinos[i];
                    container.innerHTML += `
                        <div class="card_treino">
                            <h3>${treino.titulo}</h3>
                            <p><b>Nível:</b> ${treino.nivel}</p>
                            <p>${treino.descricao}</p>
                        </div>
                    `;
                }
            });
        }
    }).catch(function (erro) {
        console.error("Erro na busca:", erro);
    });
}

    window.onload = function () {
        buscarTreino();
    }
</script>